package dev.tonholo.kotlin.wrapper.highlightjs.core.style

import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.A11yDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.A11yLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.AgateStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.AnOldHopeStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.AndroidStudioStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.ArduinoLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.ArtaStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.AsceticStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.AtomOneDarkReasonableStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.AtomOneDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.AtomOneLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.BrownPaperStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.CodepenEmbedStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.ColorBrewerStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.DarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.DefaultStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.DevibeansStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.DoccoStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.FarStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.FelipecStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.FoundationStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.GithubDarkDimmedStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.GithubDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.GithubStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.GmlStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.GoogleCodeStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.GradientDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.GradientLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.GrayscaleStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.HighlightJsStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.HybridStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.IdeaStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.IntellijLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.IrBlackStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.IsblEditorDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.IsblEditorLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.KimbieDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.KimbieLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.LightfairStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.LioshiStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.MagulaStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.MonoBlueStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.MonokaiStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.MonokaiSublimeStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.NightOwlStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.NnfxDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.NnfxLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.NordStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.ObsidianStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.OneCLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.PandaSyntaxDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.PandaSyntaxLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.ParaisoDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.ParaisoLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.PojoaqueStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.PurebasicStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.QtcreatorDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.QtcreatorLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.RainbowStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.RouterosStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.SchoolBookStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.ShadesOfPurpleStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.SrceryStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.StackoverflowDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.StackoverflowLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.SunburstStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.TokyoNightDarkStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.TokyoNightLightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.TomorrowNightBlueStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.TomorrowNightBrightStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.VSStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.Vs2015Style
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.XcodeStyle
import dev.tonholo.kotlin.wrapper.highlightjs.core.mappings.style.Xt256Style
import kotlinx.browser.document
import org.w3c.dom.Element

private const val HLJS_STYLE_ID = "hljs-style"

data class SupportedStyle(
    val default: HighlightJsStyle,
    val dark: HighlightJsStyle? = null,
) {
    companion object {
        val OneC by lazy {
            SupportedStyle(default = OneCLightStyle)
        }
        val A11y by lazy {
            SupportedStyle(
                default = A11yLightStyle,
                dark = A11yDarkStyle,
            )
        }
        val Agate by lazy { SupportedStyle(default = AgateStyle) }
        val AnOldHope by lazy { SupportedStyle(default = AnOldHopeStyle) }
        val AndroidStudio by lazy { SupportedStyle(default = AndroidStudioStyle) }
        val ArduinoLight by lazy { SupportedStyle(default = ArduinoLightStyle) }
        val Arta by lazy { SupportedStyle(default = ArtaStyle) }
        val Ascetic by lazy { SupportedStyle(default = AsceticStyle) }
        val AtomOneDarkReasonable by lazy { SupportedStyle(default = AtomOneDarkReasonableStyle) }
        val AtomOne by lazy {
            SupportedStyle(
                default = AtomOneLightStyle,
                dark = AtomOneDarkStyle,
            )
        }
        val BrownPaper by lazy { SupportedStyle(default = BrownPaperStyle) }
        val CodepenEmbed by lazy { SupportedStyle(default = CodepenEmbedStyle) }
        val ColorBrewer by lazy { SupportedStyle(default = ColorBrewerStyle) }
        val Default by lazy {
            SupportedStyle(
                default = DefaultStyle,
                dark = DarkStyle,
            )
        }
        val Devibeans by lazy { SupportedStyle(default = DevibeansStyle) }
        val Docco by lazy { SupportedStyle(default = DoccoStyle) }
        val Far by lazy { SupportedStyle(default = FarStyle) }
        val Felipec by lazy { SupportedStyle(default = FelipecStyle) }
        val Foundation by lazy { SupportedStyle(default = FoundationStyle) }
        val Github by lazy {
            SupportedStyle(
                default = GithubStyle,
                dark = GithubDarkStyle,
            )
        }
        val GithubDimmed by lazy {
            SupportedStyle(
                default = GithubStyle,
                dark = GithubDarkDimmedStyle,
            )
        }
        val Gml by lazy { SupportedStyle(default = GmlStyle) }
        val GoogleCode by lazy { SupportedStyle(default = GoogleCodeStyle) }
        val Gradient by lazy {
            SupportedStyle(
                default = GradientLightStyle,
                dark = GradientDarkStyle,
            )
        }
        val Grayscale by lazy { SupportedStyle(default = GrayscaleStyle) }
        val Hybrid by lazy { SupportedStyle(default = HybridStyle) }
        val Idea by lazy { SupportedStyle(default = IdeaStyle) }
        val IntellijLight by lazy { SupportedStyle(default = IntellijLightStyle) }
        val IrBlack by lazy { SupportedStyle(default = IrBlackStyle) }
        val IsblEditor by lazy {
            SupportedStyle(
                default = IsblEditorLightStyle,
                dark = IsblEditorDarkStyle,
            )
        }
        val KimbieDark by lazy { SupportedStyle(default = KimbieDarkStyle) }
        val KimbieLight by lazy {
            SupportedStyle(
                default = KimbieLightStyle,
                dark = KimbieDarkStyle,
            )
        }
        val Lightfair by lazy { SupportedStyle(default = LightfairStyle) }
        val Lioshi by lazy { SupportedStyle(default = LioshiStyle) }
        val Magula by lazy { SupportedStyle(default = MagulaStyle) }
        val MonoBlue by lazy { SupportedStyle(default = MonoBlueStyle) }
        val MonokaiSublime by lazy { SupportedStyle(default = MonokaiSublimeStyle) }
        val Monokai by lazy { SupportedStyle(default = MonokaiStyle) }
        val NightOwl by lazy { SupportedStyle(default = NightOwlStyle) }
        val Nnfx by lazy {
            SupportedStyle(
                default = NnfxLightStyle,
                dark = NnfxDarkStyle,
            )
        }
        val Nord by lazy { SupportedStyle(default = NordStyle) }
        val Obsidian by lazy { SupportedStyle(default = ObsidianStyle) }
        val PandaSyntax by lazy {
            SupportedStyle(
                default = PandaSyntaxLightStyle,
                dark = PandaSyntaxDarkStyle,
            )
        }
        val Paraiso by lazy {
            SupportedStyle(
                default = ParaisoLightStyle,
                dark = ParaisoDarkStyle,
            )
        }
        val Pojoaque by lazy { SupportedStyle(default = PojoaqueStyle) }
        val Purebasic by lazy { SupportedStyle(default = PurebasicStyle) }
        val Qtcreator by lazy {
            SupportedStyle(
                default = QtcreatorLightStyle,
                dark = QtcreatorDarkStyle,
            )
        }
        val Rainbow by lazy { SupportedStyle(default = RainbowStyle) }
        val Routeros by lazy { SupportedStyle(default = RouterosStyle) }
        val SchoolBook by lazy { SupportedStyle(default = SchoolBookStyle) }
        val ShadesOfPurple by lazy { SupportedStyle(default = ShadesOfPurpleStyle) }
        val Srcery by lazy { SupportedStyle(default = SrceryStyle) }
        val Stackoverflow by lazy {
            SupportedStyle(
                default = StackoverflowLightStyle,
                dark = StackoverflowDarkStyle,
            )
        }
        val Sunburst by lazy { SupportedStyle(default = SunburstStyle) }
        val TokyoNight by lazy {
            SupportedStyle(
                default = TokyoNightLightStyle,
                dark = TokyoNightDarkStyle,
            )
        }
        val TomorrowNightBlue by lazy { SupportedStyle(default = TomorrowNightBlueStyle) }
        val TomorrowNightBright by lazy { SupportedStyle(default = TomorrowNightBrightStyle) }
        val VS by lazy { SupportedStyle(default = VSStyle) }
        val Vs2015 by lazy { SupportedStyle(default = Vs2015Style) }
        val Xcode by lazy { SupportedStyle(default = XcodeStyle) }
        val Xt256 by lazy { SupportedStyle(default = Xt256Style) }
    }
}

fun SupportedStyle.applyStyle(isDarkMode: Boolean) {
    val style = document.querySelector(hljsLinkStyleSelector(HLJS_STYLE_ID))
        ?: document.createElement(localName = "link")
            .apply {
                setAttribute(qualifiedName = "type", value = "text/css")
                setAttribute(qualifiedName = "rel", value = "stylesheet")
                setAttribute(qualifiedName = "id", value = HLJS_STYLE_ID)
            }
            .also { linkElement ->
                requireNotNull(document.head).appendChild(linkElement)
            }

    toggleStyle(isDarkMode, style)
}

private fun SupportedStyle.toggleStyle(
    isDarkMode: Boolean,
    style: Element
) {
    val href = when {
        dark != null && isDarkMode -> dark.import
        else -> default.import
    }
    style.setAttribute(qualifiedName = "href", value = href)
}

private fun hljsLinkStyleSelector(id: String) = "link[id=\"$id\"]"

internal fun SupportedStyle.toggleStyle(isDarkMode: Boolean) {
    document.querySelector(hljsLinkStyleSelector(HLJS_STYLE_ID))?.let {
        toggleStyle(isDarkMode, it)
    }
}
